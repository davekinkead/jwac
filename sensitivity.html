<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>JWAC Sensitivity Analysis</title>
  <style>

    body { text-align: center; margin: 0; padding: 0; }

    #chart { margin: 1em; }
    #info { position: absolute; bottom: 50px; right: 50px; width: 300px; height: 200px; border: 1px solid #CCC; padding: 1em; box-shadow: 1px 1px 5px rgba(0,0,0,0.5); }

    .node:hover { opacity: 0.5; }
    .link:hover { opacity: 0.325; }
    
  </style>
</head>
<body>

<h1>JWAC Sensitivity Analysis</h1>

<div id="chart"></div>
<div id="info">
  <h3>Click to Reset</h3>
  <p>TODO: Allow the user to override gate values for sensitivity analysis.  The downstream gates will turn red if course min/max is exceeded.</p>
</div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

  var gates = ["NEOC", "ADFA", "Transfer", "Changeover", "JWAC 1", "JWAC 2", "MSB", "JWAC 3 Shore", "JWAC 3 Sea", "Fleet Board", "NOLC1", "JWAC Warfare", "JWAC Simulator", "JWAC Endorsement"];

  var width = screen.width - 100, height = screen.height - 300, nodeWidth = 50, nodePadding = 2, workingData;

  var svg = d3.select('#chart')
    .append('svg')
    .attr('width', width)
    .attr('height', height);

  var sumNodes = function(nodes) {
    return nodes.map(function(node) { 
        return node.members.length;
      }).reduce(function(prev, curr) { 
        return prev + curr;
      }); 
  }

  var createNodes = function(buckets) {
    var gate = 0;

    return [].concat.apply([], buckets.map(function(bucket) {
      var nodes = Object.keys(bucket).map(function(name) {
        return {"name": name, "members": bucket[name], "gate": gate }
      });
      gate++;
      return positionNodesVertically(nodes);
    }));
  }

  var positionNodesVertically = function(nodes) {
    var denominator = sumNodes(nodes), pos = 0;
    denominator = 100;

    return nodes.sort(function(a, b) { 
        return b.members.length - a.members.length;
      }).map(function(node) {
        node.y = pos / denominator * height + nodePadding;
        node.height = node.members.length / denominator * height - nodePadding;
        pos += node.members.length;
        return node;
      });
  }

  var createBuckets = function(data) {
    var buckets = []

    data.forEach(function(member) {
      member.postings.forEach(function(posting, i) {
        if (buckets[i] == undefined)
          buckets[i] = {};
        if (buckets[i].hasOwnProperty(posting)) {
          buckets[i][posting].push(member.id);
        } else {
          buckets[i][posting] = [member.id];
        }
      });
    });

    return buckets;    
  }

  var createLinks = function(nodes) {
    var links = Array.apply(null, Array(nodes.length)).map(function() { return []; });

    nodes.forEach(function(node, index) {
      nodes.forEach(function(n, i) {
        if (node.gate == n.gate - 1 && index !== i)
          node.members.forEach(function(id) {
            if (n.members.indexOf(id) !== -1)
              if (links[index].hasOwnProperty(i))
                links[index][i] += 1;
              else
                links[index][i] = 1;
          });
      });
    });

    var results = []
    links.forEach(function(array, index) {
      array.forEach(function(el, i) {
        results.push ({"source": index, "target": i, "value": el});
      });        
    });
    return results;
  }

  var positionNodesAndLinks = function(nodes, links) {
    nodes.forEach(function(node) {
      node.x = node.gate * 125;
    });

    var offsetLHS = [], offsetRHS = [];
    links.forEach(function(link) {
      var linkL = link.value * (nodes[link.source].height) / nodes[link.source].members.length
      var linkR = link.value * (nodes[link.target].height) / nodes[link.target].members.length

      if (!offsetLHS.hasOwnProperty(link.source))
        offsetLHS[link.source] = 0;
      if (!offsetRHS.hasOwnProperty(link.target))
        offsetRHS[link.target] = 0;

      link.proportion = link.value / nodes[link.source].members.length;
      link.y0 = nodes[link.source].y + offsetLHS[link.source];
      link.y1 = nodes[link.target].y + offsetRHS[link.target];
      link.y2 = nodes[link.target].y + offsetRHS[link.target] + linkR;
      link.y3 = nodes[link.source].y + offsetLHS[link.source] + linkL;
      offsetLHS[link.source] += linkL;
      offsetRHS[link.target] += linkR;

      link.x0 = nodes[link.source].x + nodeWidth + 0;
      link.x1 = nodes[link.target].x - 0;
    });
  }

  function renderChart(data) {
  
    var colour = function(target) {
      if (gates.indexOf(target) !== -1) {
        return '#2E86D1';
      } else {
        return '#666';
      }
    }  
  
    var linkPoints = function(d) {
      return 'M'+ d.x0 +' '+ d.y0 
        +' L'+ d.x1 +' '+ d.y1 
        +' L'+ d.x1 +' '+ d.y2 
        +' L'+ d.x0 +' '+ d.y3
        +' Z';
    }

    workingData = data;
    var buckets = createBuckets(workingData);
    var nodeData = createNodes(buckets);
    var linkData = createLinks(nodeData);

    positionNodesAndLinks(nodeData, linkData);

    console.log(nodeData);
    console.log(linkData);

    var nodes = svg.selectAll('.node')
      .data(nodeData);

    nodes.enter()
      .append('rect')
      .attr('class', 'node')
      .attr('x', function(d) { return d.x })
      .attr('y', function(d) { return d.y })
      .attr('width', nodeWidth) //function(d) { return nodeWidth(node); })
      .attr('height', function(d) { return d.height })
      .attr('opacity', 0.375)
      .on('dblclick', function(d) { 
        workingData = workingData.filter(function(datum) {
          return (d.members.indexOf(datum.id) !== -1);
        });
        renderChart(workingData);
      })
      .append('title');

    nodes.transition()
      .attr('x', function(d) { return d.x })
      .attr('y', function(d) { return d.y })
      .attr('height', function(d) { return d.height })
      .attr('fill', function(d) { return colour(d.name) })
      .select('title').text(function(d) { return d.name + '\n\r ' + d.members.length });
    
    nodes.exit()
      .remove();

    var links = svg.selectAll('.link')
      .data(linkData);

    links.enter()
      .append('path')
      .attr('d', linkPoints)
      .attr('opacity', 0.25)
      .attr('class', 'link')
      .append('title'); 

    links.transition()
      .attr('d', linkPoints)
      .attr('fill', function(d) { return colour(nodeData[d.target].name) })
      .select('title')
      .text(function(d) { return nodeData[d.source].name +' -> '+ nodeData[d.target].name +'\n\r'+ d.value +' ('+ d.proportion.toFixed(2) * 100 +'%)'});

    links.exit().remove();
  }

  //d3.json('data.json', function(json) {
  var json = [{"id":8151000,"name":"LEUT Olenna Lannister","postings":["ADFA","Medical"]},{"id":8151001,"name":"LEUT Catelyn Tarth","postings":["ADFA","Resignation"]},{"id":8151002,"name":"LEUT Jorah Mormont","postings":["Transfer","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151003,"name":"SBLT Varys Tyrell","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151004,"name":"SBLT Cersei H'ghar","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151005,"name":"MIDN Tormund Naharis","postings":["ADFA","Resignation"]},{"id":8151006,"name":"LEUT Ramsay Clegane","postings":["ADFA","Resignation"]},{"id":8151007,"name":"SBLT Shae Stark","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","Medical"]},{"id":8151008,"name":"LEUT Daario Stark","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Failure"]},{"id":8151009,"name":"SBLT Olenna Missandei","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151010,"name":"MIDN Melisandre Bolton","postings":["ADFA","JWAC 1","JWAC 2","MSB","Medical"]},{"id":8151011,"name":"SBLT Daario Bolton","postings":["ADFA","Resignation"]},{"id":8151012,"name":"LEUT Jaqen Giantsbane","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151013,"name":"ASBT Tommen Targaryen","postings":["NEOC","JWAC 1","JWAC 2","Failure"]},{"id":8151014,"name":"ASBT Arya Greyjoy","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151015,"name":"SBLT Ygritte Lannister","postings":["NEOC","Resignation"]},{"id":8151016,"name":"LEUT Jaqen Ygritte","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151017,"name":"SBLT Cersei Clegane","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151018,"name":"LEUT Jorah Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151019,"name":"ASBT Baelish Lannister","postings":["NEOC","Resignation"]},{"id":8151020,"name":"SBLT Daario Melisandre","postings":["NEOC","JWAC 1","JWAC 2","Resignation"]},{"id":8151021,"name":"MIDN Olenna Drogo","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151022,"name":"LEUT Bran Seaworth","postings":["NEOC","JWAC 1","JWAC 2","Failure"]},{"id":8151023,"name":"MIDN Eddard Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151024,"name":"LEUT Davos Melisandre","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151025,"name":"SBLT Ygritte Seaworth","postings":["NEOC","JWAC 1","Failure"]},{"id":8151026,"name":"ASBT Missandei Lannister","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151027,"name":"LEUT Tywin Gendry","postings":["ADFA","JWAC 1","JWAC 2","MSB","Failure"]},{"id":8151028,"name":"LEUT Sandor Giantsbane","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151029,"name":"ASBT Jeor Bolton","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","Medical"]},{"id":8151030,"name":"ASBT Cersei Stark","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151031,"name":"SBLT Roose Bolton","postings":["Transfer","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151032,"name":"LEUT Stannis Tyrell","postings":["NEOC","Resignation"]},{"id":8151033,"name":"SBLT Margaery Drogo","postings":["ADFA","Resignation"]},{"id":8151034,"name":"SBLT Eddard Clegane","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Failure"]},{"id":8151035,"name":"LEUT Arya Naharis","postings":["ADFA","Resignation"]},{"id":8151036,"name":"SBLT Ygritte Lannister","postings":["Transfer","JWAC 1","JWAC 2","Failure"]},{"id":8151037,"name":"SBLT Tommen Lannister","postings":["ADFA","Medical"]},{"id":8151038,"name":"LEUT Eddard Stark","postings":["NEOC","Resignation"]},{"id":8151039,"name":"MIDN Sansa Snow","postings":["ADFA","Resignation"]},{"id":8151040,"name":"ASBT Brienne Bolton","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Resignation"]},{"id":8151041,"name":"ASBT Daenerys Gilly","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151042,"name":"SBLT Samwell Naharis","postings":["ADFA","Resignation"]},{"id":8151043,"name":"SBLT Samwell Snow","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151044,"name":"SBLT Brienne H'ghar","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151045,"name":"MIDN Gendry Bolton","postings":["ADFA","Medical"]},{"id":8151046,"name":"ASBT Shae Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151047,"name":"SBLT Roose Tarly","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151048,"name":"LEUT Tyrion Melisandre","postings":["ADFA","JWAC 1","JWAC 2","MSB","Medical"]},{"id":8151049,"name":"SBLT Theon Melisandre","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151050,"name":"LEUT Theon Drogo","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","Failure"]},{"id":8151051,"name":"MIDN Eddard Stark","postings":["ADFA","Medical"]},{"id":8151052,"name":"SBLT Jeor Giantsbane","postings":["NEOC","Resignation"]},{"id":8151053,"name":"SBLT Varys Stark","postings":["ADFA","Medical"]},{"id":8151054,"name":"MIDN Viserys Bronn","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Failure"]},{"id":8151055,"name":"MIDN Talisa Missandei","postings":["ADFA","Medical"]},{"id":8151056,"name":"ASBT Gendry Stark","postings":["ADFA","Medical"]},{"id":8151057,"name":"ASBT Arya Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","Failure"]},{"id":8151058,"name":"ASBT Tywin Sand","postings":["NEOC","JWAC 1","JWAC 2","MSB","Failure"]},{"id":8151059,"name":"LEUT Stannis Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151060,"name":"SBLT Brienne Lannister","postings":["ADFA","Resignation"]},{"id":8151061,"name":"ASBT Sandor Tarth","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151062,"name":"ASBT Jeor Ygritte","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","Failure"]},{"id":8151063,"name":"MIDN Khal Sand","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151064,"name":"SBLT Jon Drogo","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","Medical"]},{"id":8151065,"name":"ASBT Sandor Stark","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151066,"name":"SBLT Bronn Tarly","postings":["NEOC","JWAC 1","JWAC 2","MSB","Medical"]},{"id":8151067,"name":"ASBT Tommen Stark","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","Failure"]},{"id":8151068,"name":"MIDN Ellaria Gendry","postings":["ADFA","Resignation"]},{"id":8151069,"name":"LEUT Sansa Melisandre","postings":["ADFA","JWAC 1","JWAC 2","MSB","Failure"]},{"id":8151070,"name":"SBLT Ellaria Baratheon","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151071,"name":"LEUT Jorah Stark","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151072,"name":"SBLT Davos Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151073,"name":"MIDN Joffrey Missandei","postings":["ADFA","Resignation"]},{"id":8151074,"name":"SBLT Jaqen Targaryen","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Failure"]},{"id":8151075,"name":"ASBT Bronn Stark","postings":["Changeover","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151076,"name":"MIDN Sandor Missandei","postings":["NEOC","Medical"]},{"id":8151077,"name":"MIDN Bran Baelish","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","Medical"]},{"id":8151078,"name":"MIDN Jon Bolton","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151079,"name":"SBLT Ramsay Lannister","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151080,"name":"MIDN Samwell Bronn","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151081,"name":"ASBT Margaery Snow","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151082,"name":"SBLT Gilly Tyrell","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","Failure"]},{"id":8151083,"name":"ASBT Jon H'ghar","postings":["ADFA","Medical"]},{"id":8151084,"name":"ASBT Daenerys Drogo","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","Failure"]},{"id":8151085,"name":"SBLT Shae Mormont","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","Failure"]},{"id":8151086,"name":"SBLT Davos Lannister","postings":["NEOC","Medical"]},{"id":8151087,"name":"SBLT Daenerys Baratheon","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Medical"]},{"id":8151088,"name":"LEUT Khal Stark","postings":["Transfer","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Failure"]},{"id":8151089,"name":"MIDN Baelish Bronn","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Medical"]},{"id":8151090,"name":"MIDN Jorah Tyrell","postings":["ADFA","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151091,"name":"MIDN Baelish Bronn","postings":["NEOC","Medical"]},{"id":8151092,"name":"SBLT Sandor Ygritte","postings":["ADFA","Resignation"]},{"id":8151093,"name":"ASBT Daario Giantsbane","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151094,"name":"ASBT Gilly Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151095,"name":"MIDN Shae Baratheon","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151096,"name":"SBLT Bran Bolton","postings":["Transfer","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151097,"name":"LEUT Jeor Stark","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","Failure"]},{"id":8151098,"name":"SBLT Olenna Melisandre","postings":["NEOC","JWAC 1","JWAC 2","MSB","JWAC 3 Shore","JWAC 3 Sea","Fleet Board","NOLC1","JWAC Warfare","JWAC Simulator","JWAC Endorsement"]},{"id":8151099,"name":"LEUT Joffrey Lannister","postings":["NEOC","JWAC 1","Failure"]}]

    renderChart(json);
    d3.select('#info').on('dblclick', function() {renderChart(json)} );
 
  //});

</script>

</body>
</html>